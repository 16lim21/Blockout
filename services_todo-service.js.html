<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/todo-service.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/todo-service.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Service to interact with todo database
 * @module services/ToDoService
 */
const ToDo = require('../models/todo')
const UserService = require('./user-service')

/**
 * Gets all users from mongodb database
 * @param {String} userId - User ID representing current user
 * @returns {Document} - Returns all todo documents for a given user
 */
async function findAllItems (userId) {
    const user = await UserService.getUser(userId)
    const todos = user.todos
    return ToDo.find({ _id: { $in: todos } })
}

/**
 * Get specific document
 * @param {String} id - ToDo ID string
 * @returns {document} - returns document by ID field
 */
function getItem (id) {
    return ToDo.findById({ _id: id })
}

/**
 * Post new item
 * @function
 * @param {Object} body - object representing todo item
 * @param {String} userid - id for user that created the todo item
 * @returns {Promise} â€“ Promise to return document in mongoDB database
 */
async function postItem (body, userid) {
    if (!userid) throw Error('missing user id')

    const todo = new ToDo(body)

    const user = await UserService.pushItem(userid, 'todos', todo.id)
    if (user instanceof Error) throw user

    return todo.save().catch((error) => {
        throw error
    })
}

function patchItem (id, body, flags) {
    return ToDo.findByIdAndUpdate({ _id: id }, body, flags)
}

/**
 * Delete specific item and from user todo array
 * @param {string} id - ID representing todo object
 */
function deleteItem (id, userid) {
    return ToDo.deleteOne({ _id: id })
        .then(() => UserService.deleteItem(userid, 'todos', id))
        .catch((error) => {
            throw error
        })
}

module.exports = {
    findAllItems,
    getItem,
    postItem,
    patchItem,
    deleteItem
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-api_routes_auth.html">api/routes/auth</a></li><li><a href="module-api_routes_blockout.html">api/routes/blockout</a></li><li><a href="module-api_routes_users.html">api/routes/users</a></li><li><a href="module-server.html">server</a></li><li><a href="module-services_AuthService.html">services/AuthService</a></li><li><a href="module-services_CalendarService.html">services/CalendarService</a></li><li><a href="module-services_ToDoService.html">services/ToDoService</a></li><li><a href="module-services_UserService.html">services/UserService</a></li></ul><h3>Namespaces</h3><ul><li><a href="Todo.html">Todo</a></li><li><a href="User.html">User</a></li></ul><h3>Classes</h3><ul><li><a href="module-services_AuthService-AuthService.html">AuthService</a></li><li><a href="module-services_CalendarService-CalendarService.html">CalendarService</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Dec 20 2020 23:39:23 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
